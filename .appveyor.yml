clone_depth: 50

platform:
    - x64

configuration:
    # - Debug
    # - Release
    - RelWithDebInfo

install:
    - git submodule update --init --recursive
    - set PATH=C:\msys64\mingw64\bin;C:\msys64\usr\bin;%PATH%
    - pacman --noconfirm -Syu
    - pacman --noconfirm -S mingw-w64-x86_64-jemalloc
    - pacman --noconfirm -S mingw-w64-x86_64-boost
    - pacman --noconfirm -S mingw-w64-x86_64-libxml++2.6
    # - pacman --noconfirm -S mingw-w64-x86_64-qt5

before_build:
    - md install
    - md build

build_script:
    - python .\install.py --mingw64 -j 2 --prefix=.\install -DBUILD_GUI=OFF -DBUILD_TESTS=OFF --build-type=%CONFIGURATION%
    - install\bin\scram.exe --version
    - install\bin\scram.exe input\TwoTrain\two_train.xml
    - cd build
    - cmake .. -DPACKAGE=ON
    - cpack

artifacts:
    - path: build/SCRAM*.exe
      name: installer
